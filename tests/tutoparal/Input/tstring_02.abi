#######################################
#       INPUT FILE FOR ABINIT         #
#                                     #
#  Hydronium ion + NH3 molecule       #
#  Ground state calculation           #
#  keeping O and H atoms fixed        #
#######################################

# Definition of the unit cell
# ===========================
natom         8

ntypat        3

# Species     
#             O   N   H   
znucl         
              8   7   1   

typat         
              1   3   3   2   3   3   3   3   

acell         1.90000000000000e+01   9.45000000000000e+00   9.45000000000000e+00

xcart       
              9.50000000000000e+00   4.72500000000000e+00   4.72500000000000e+00  # H2O
              8.91357294161086e+00   4.35756555661331e+00   6.43659396250609e+00  # H2O
              8.87357878934701e+00   6.42369270345131e+00   4.36312956625979e+00  # H2O
              1.70589045315426e+01   4.72500000000000e+00   4.72500000000000e+00  # NH3
              1.79793316806072e+01   4.43471557335327e+00   3.02984046074293e+00  # NH3
              1.74602374842793e+01   3.23955555123806e+00   5.92092819588101e+00  # NH3
              1.77274721498000e+01   6.37041827058959e+00   5.52807513366510e+00  # NH3
              1.50876506037788e+01   4.83770795804868e+00   4.46861683066319e+00  # proton

pp_dirpath "$ABI_PSPDIR/"
pseudos "8o_hard.paw, 7n.paw, 1h.paw"

# Electronic configuration
# ========================
nband         10       # Number of bands to compute
kptopt        0        # No autogeneration of kpts so only use Gamma (0,0,0)
charge        1.0      # Charge of the simulation cell

# Convergence parameters
# ======================
ecut          20
pawecutdg     40

# Control of the SCF cycle
# ========================
toldff        5.0d-7   # Stopping criterion of SCF cycle
nstep         50       # Maximal number of SCF steps

# Control of the relaxation
# =========================
ionmov        2        # BFGS (Broyden) algorithm for ions relaxation
optcell       0        # No cell optimization
ntime         500      # Max. number of "time" steps
tolmxf        5.0d-5   # Stopping criterion of relaxation cycle
natfix        2 
iatfix        1 4      # Keep O and N atoms fixed

# Parallelization
# ===============
paral_kgb     1
bandpp        10

#%%<BEGIN TEST_INFO>
#%% [setup]
#%% executable = abinit
#%% [files]
#%% [NCPU_1]
#%% files_to_test = 
#%%   tstring_02_MPI1.abo, tolnlines = 100, tolabs = 1.100e-03, tolrel = 3.000e-03
#%% [paral_info]
#%% nprocs_to_test = 1
#%% max_nprocs = 1
#%% [extra_info]
#%% authors = G. Genestes, M. Torrent, J. Bieder
#%% keywords = 
#%% description = 
#%%   Hydronium ion + NH3 molecule      
#%%   Ground state calculation         
#%%   keeping O and H atoms fixed     
#%%<END TEST_INFO>
