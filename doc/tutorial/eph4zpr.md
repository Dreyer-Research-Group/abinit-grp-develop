---
authors: MG
---

# Zero-point renormalization and temperature dependent band structures

This page provides

## Formalism

Last but not least, one can estimate the correction to the zero-point renormalization 
of the band gap in polar materials using a generalized Fr\"ohlich model based on 
*ab initio** effective masses~\cite{Laflamme2016}.
An example input file is available in [[test:v7_88]].

The electron-phonon self-energy [[cite:Giustino2017]] describes the renormalization of the single-particle
energies due to the EPH interactions as well as the lifetime of the excitations.
First-principles calculations of the EPH self-energy are therefore crucial to understand the temperature-dependence
of band gaps, including the correction due to zero-point motion, as well as for computing phonon-limited mobilities
within the Boltzmann transport equation.
In ABINIT v9, it will be possible to compute the EPH self-energy in the Kohn-Sham representation using the EPH matrix elements.
The code employs optimized algorithms to compute either the full self-energy 
(needed for QP corrections and spectral functions)
When computing the full self-energy, it is possible to reduce the number of empty states required for convergence
by using the first-order wavefunctions obtained by solving the relevant Sternheimer equation.

From XG-ABINIT2019

The static Debye-Waller (DW) term involves the second order derivative of 
the KS potential with respect to the nuclear displacements.
State-of-the-art implementations approximate the DW contribution with

\begin{equation}
\label{eq:dw_selfen}
\Sigma_{n\kk}^{\DW} = \sum_{\qq\nu m} (2 n_{\qq\nu} + 1) \dfrac{g_{mn\nu}^{2,DW}(\kk, \qq)}{\ee_{n\kk} - \ee_{m\kk}},
\end{equation}

where $g_{mn\nu}^{2,\DW}(\kk,\qq)$ is an effective matrix element that, within the rigid-ion approximation, 
can be expressed in terms of the $\gkkp$ matrix elements~\cite{Giustino2017}. 
In principle, the quasi-particle (QP) excitations are defined by the solution(s) 
in the complex plane of the equation $ z = \ee_\nk + \Sigma_\nk^{\text{e-ph}}(z) $.
%provided that the non-diagonal components of the self-energy can be neglected. [[cite:Eiguren2009]]
In practice, the problem is usually simplified by seeking approximated solutions along the real axis following two different approaches. 
In the on-the-mass-shell approximation, the QP energy is given by the real part 
of the self-energy evaluated at the bare KS eigenvalue

\begin{equation}
\ee^\QP_\nk = \ee_\nk + \Re\, \Sigma_\nk^{\text{e-ph}}(\ee_\nk).
\end{equation}

The second approach linearizes the self-energy near the KS eigenvalue and evaluates the QP correction using

\begin{equation}
  \ee^\QP_\nk = \ee_\nk
      + Z_\nk\,\Re  \Sigma^\text{e-ph}_\nk(\ee_\nk)
\end{equation}

with the renormalization factor $Z$ given by

\begin{equation}
  Z_\nk= \left(1 - \Re\left[ \frac{\partial\Sigma^\text{e-ph}_{\nk}}{\partial\ee}\right]\Bigg|_{\ee=\ee_\nk} \right)^{-1}.
\end{equation}

Both approaches are implemented in ABINIT although it should be noted that, according to recent works, the on-the-mass-shell approach provides results that are closer to those obtained with more advanced techniques 
based on the cumulant expansion [[cite:Nery2018]] 
or self-energy calculations employing an eigenvalueâ€“self-consistent cycle [[cite:Brown-Altvater2020]].

Accurate calculations of e-ph renormalization are still challenging even by present standards, 
because the e-ph self-energy is quite sensitive to the $\qq$-point sampling. 
Moreover a large number of empty states $m$ is usually required to converge the real part of the self-energy. 
In order to avoid the explicit computation of the DFPT scattering potentials on dense $\qq$-grids, 
ABINIT generalizes the Fourier-based interpolation scheme proposed by Eiguren {\it et al.}~\cite{Eiguren2008} 
to account for the non-analytical behaviour associated to the long-range interactions present in semiconductors [[cite:Vogl1976]]. 
The dipolar potentials generated by the Born effective charges in polar materials are treated 
using a generalized Fr\"ohlich model~\cite{Verdi2015, Sjakste2015}. %~\cite{Frohlich1954} proposed in
Further details concerning the implementation are given in Ref.~\onlinecite{Gonze2019}. 
In order to accelerate the convergence with the number of empty states, ABINIT replaces the contributions 
given by the high-energy states above a certain band index $M$ with the solution 
of a non-self-consistent Sternheimer equation in which only the first $M$ states are required. 
The methodology, proposed in [[cite:Gonze2011]], is based on a quasi-static approximation 
in which the phonon frequencies in the denominator of Eq.~(\ref{eq:fan_selfen}) are neglected and 
the frequency dependence of $\Sigma$ is approximated with the value computed at $\omega = \enk$. 
This approximation is justified when the bands above $M$ are sufficiently high in energy with respect 
to the $n\kk$ states that must be corrected.
Furthermore, this upper-bands contribution to $\Sigma$ converges quickly with respect 
to $\qq$-points sampling, and it can be safely computed on a coarse $\qq$-grid \cite{Brown-Altvater2020, Chan2020}.

The code can compute QP corrections and lifetimes due to e-ph scattering as well as spectral functions. 

\begin{equation}
\mu_{e,\alpha\beta} = \frac{-1}{\Omega_0 n_e}
\sum_n \int \frac{d\kk}{\Omega_\BZ} \vnka \vnkb \tau_{n\kk} \left.\frac{\partial f}{\partial\varepsilon}\right|_{\enk},
\label{eq:mobility}
\end{equation}

%where $\vnk$ is the matrix element of the velocity operator. % and $\alpha$ and $\beta$ are Cartesian coordinates.

Last but not least, ABINIT provides a specialized driver to interpolate the DFPT scattering potentials, 
compute e-ph matrix elements on arbitrarily dense $\kk$-meshes and save the results to netcdf files. 
This driver can be used by externals codes such as \BERKELEYGW~\cite{Deslippe2012} to treat e-ph interactions 
at the $GW$ level as discussed in Ref.~\onlinecite{Li2019}.
