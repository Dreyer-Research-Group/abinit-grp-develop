<!--                                                                                     -->
<!-- This file has been produced by generate_doc.py using different .yml  or .bib files. -->
<!-- It is useless to modify it. Modify the related .yml  or .bib files instead.         -->
<!--                                                                                     -->
<html>
<head><title>DFT+U </title>
<link rel=stylesheet type="text/css" href="../../formabinit.css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/HTML-CSS"],
  tex2jax: {inlineMath: [['$','$']]},
  displayAlign: "center",
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>
<body bgcolor="#ffffff">

<hr>
<a name="top"></a>

<h1>The DFT+U approximation</h1>
<h3>This page gives hints on how to perform a DFT+U calculation with the ABINIT package.
<hr>

<h5>Copyright (C) 2016-2017 ABINIT group (BAmadon)
<script type="text/javascript" src="../../js_files/copyright.js"> </script>
</h5>

<script type="text/javascript" src="../../js_files/list_internal_links_for_generated_files.js"> </script>

 Mentioned in &nbsp; <a href="../../users/generated_files/help_features.html#5">help_features#5</a>. 
 <hr>
 <h3><b>Table of content: </b></h3> 
 <ul> <li>1. <a href="topic_DFT+U.html#1">Introduction.</a><li>2. <a href="topic_DFT+U.html#2">Related lesson(s) of the tutorial.</a><li>3. <a href="topic_DFT+U.html#3">Related input variables.</a><li>4. <a href="topic_DFT+U.html#4">Selected input files.</a><li>5. <a href="topic_DFT+U.html#5">References.</a></ul>

&nbsp; 
<HR ALIGN=left> 
<a name="1">&nbsp;</a>
<h3><b>1. Introduction.</b></h3>


<p> This feature is available only in PAW. The DFT+U framework is described in
<a href="../../biblio/generated_files/bib_biblio.html#Anisimov1991">[Anisimov1991]</a> and <a href="../../biblio/generated_files/bib_biblio.html#Liechtenstein1995">[Liechtenstein1995]</a>. In ABINIT, the DFT+U approximation is implemented inside the PAW atomic spheres only.
Two choices of double counting are provided: the Full Localized limit
and the Around Mean Field approximation.
Our implementation is described in <a href="../../biblio/generated_files/bib_biblio.html#Amadon2008a">[Amadon2008a]</a>.
It follows the main lines of <a href="../../biblio/generated_files/bib_biblio.html#Bengone2000">[Bengone2000]</a>. See also <a href="../../biblio/generated_files/bib_biblio.html#Czyzyk1994">[Czyzyk1994]</a>.
Forces and stress are implemented.
For details on keywords 
(<a href="../../input_variables/generated_files/varset_paw.html#lpawu">lpawu</a>,<a href="../../input_variables/generated_files/varset_paw.html#upawu">upawu</a>,<a href="../../input_variables/generated_files/varset_paw.html#jpawu">jpawu</a>,<a href="../../input_variables/generated_files/varset_paw.html#usedmatpu">usedmatpu</a>,<a href="../../input_variables/generated_files/varset_paw.html#dmatpuopt">dmatpuopt</a>,<a href="../../input_variables/generated_files/varset_paw.html#dmatudiag">dmatudiag</a>) 
see keyword <a href="../../input_variables/generated_files/varset_paw.html#usepawu">usepawu</a> in input variables.

<p> In both the output and log files, we can find:
<p>- The DFT+U contribution of energy which is contained inside the PAW Spherical terms in the output file.
<p>- The Decomposition of the LDA+U energy is given (Interaction energy, Double
  counting term, and sum of the two) in the log file.
<p>- The orbital density matrix (n_{m,m'}^{\sigma}), also called occupation
 matrix (corresponding to Eq.(9) of <a href="../../biblio/generated_files/bib_biblio.html#Bengone2000">[Bengone2000]</a> and Eq.(1) of <a href="../../biblio/generated_files/bib_biblio.html#Liechtenstein1995">[Liechtenstein1995]</a>, see also
  <a href="../../biblio/generated_files/bib_biblio.html#Amadon2008a">[Amadon2008a]</a> and variable <a href="../../input_variables/generated_files/varset_paw.html#dmatpuopt">dmatpuopt</a>) is also
  given for each atom in the basis of real spherical harmonics.
  It is given at each SCF step in the log file: one can thus check the
  convergency of the calculation.

<p> Consistency between total energy and forces in DFT+U have been checked.

<p> The implementation of DFT+U in ABINIT allows also to impose a starting density matrix in order
to compare the energy of various electronic configuration (see keywords <a href="../../input_variables/generated_files/varset_paw.html#usedmatpu">usedmatpu</a> and <a href="../../input_variables/generated_files/varset_paw.html#dmatpawu">dmatpawu</a>).

<p>
<br><br><a href=#top>Go to the top</a>



&nbsp; 
<HR ALIGN=left> 
<a name="2">&nbsp;</a>
<h3><b>2. Related lesson(s) of the tutorial.</b></h3>


<li><a href="../../tutorial/generated_files/lesson_dftu.html">The lesson on DFT+U</a> shows
how to perform a DFT+U calculation using ABINIT, and will lead to
compute the projected DOS of NiO. Prerequisite : PAW1.</li>
<br><br><a href=#top>Go to the top</a>


&nbsp; 
<hr> 
<a name="3">&nbsp;</a>
<h3><b>3. Related input variables.</b></h3>


<p>Compulsory input variables:<p>... <a href="../../input_variables/generated_files/varset_paw.html#jpawu">jpawu</a>   [value of J for PAW+U]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#lpawu">lpawu</a>   [value of angular momentum L for PAW+U]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#upawu">upawu</a>   [value of U for PAW+U]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#usepawu">usepawu</a>   [USE PAW+U (spherical part)]<br>
<p>Useful input variables:<p>... <a href="../../input_variables/generated_files/varset_paw.html#dmatpawu">dmatpawu</a>   [initial Density MATrix for PAW+U]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#usedmatpu">usedmatpu</a>   [USE of an initial Density MATrix in Paw+U]<br>
<p>Relevant internal variables:<p>... <a href="../../input_variables/generated_files/varset_internal.html#natpawu">%natpawu</a>   [Number of AToms on which PAW+U is applied]<br>
<p>Input variables for experts:<p>... <a href="../../input_variables/generated_files/varset_ffield.html#atvshift">atvshift</a>   [ATomic potential (V) energy SHIFTs]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#dmatpuopt">dmatpuopt</a>   [Density MATrix for PAW+U OPTion]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#dmatudiag">dmatudiag</a>   [Density MATrix for paw+U, DIAGonalization]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#f4of2_sla">f4of2_sla</a>   [F4 Over F2 ratio of Slater integrals]<br>
... <a href="../../input_variables/generated_files/varset_paw.html#f6of2_sla">f6of2_sla</a>   [F6 Over F2 ratio of Slater integrals]<br>
... <a href="../../input_variables/generated_files/varset_dev.html#macro_uj">macro_uj</a>   [MACRO variable that activates the determination of the U and J parameter (for the PAW+U calculations)]<br>
... <a href="../../input_variables/generated_files/varset_ffield.html#natvshift">natvshift</a>   [Number of ATomic potential (V) energy SHIFTs (per atom)]<br>
... <a href="../../input_variables/generated_files/varset_dev.html#normpawu">normpawu</a>   [NORMalize atomic PAW+U projector]<br>
... <a href="../../input_variables/generated_files/varset_dev.html#pawujat">pawujat</a>   [PAW+macro_UJ, ATom number]<br>
... <a href="../../input_variables/generated_files/varset_dev.html#pawujrad">pawujrad</a>   [PAW+macro_UJ, sphere RADius]<br>
... <a href="../../input_variables/generated_files/varset_dev.html#pawujv">pawujv</a>   [PAW+macro_UJ, potential shift (V)]<br>

<br><br><a href=#top>Go to the top</a>


&nbsp; 
<HR ALIGN=left> 
<a name="4">&nbsp;</a>
<h3><b>4. Selected input files.</b></h3>


<i><b>WARNING</b> : as of ABINITv8.6.x, the list of input files provided in the specific section of the topics Web pages is still to be reviewed/tuned. In some cases, it will be adequate, and in other cases, it might be incomplete, or perhaps even useless.</i>
<br><br>The user can find some related example input files in the ABINIT package in the directory /tests, or on the Web:
<p> tests/v5/Input: <a href="../../tests/v5/Input/t08.in">t08.in</a> 
<a href="../../tests/v5/Input/t14.in">t14.in</a> 
<a href="../../tests/v5/Input/t15.in">t15.in</a> 
<a href="../../tests/v5/Input/t16.in">t16.in</a> 
<a href="../../tests/v5/Input/t19.in">t19.in</a> 
<a href="../../tests/v5/Input/t20.in">t20.in</a> 
<a href="../../tests/v5/Input/t33.in">t33.in</a> 
<a href="../../tests/v5/Input/t37.in">t37.in</a> 
<a href="../../tests/v5/Input/t38.in">t38.in</a> 
<a href="../../tests/v5/Input/t39.in">t39.in</a> 
<a href="../../tests/v5/Input/t40.in">t40.in</a> 
<p> tests/v7/Input: <a href="../../tests/v7/Input/t21.in">t21.in</a> 
<a href="../../tests/v7/Input/t22.in">t22.in</a> 
<a href="../../tests/v7/Input/t44.in">t44.in</a> 
<br>

<br><br><a href=#top>Go to the top</a>


&nbsp; 
<HR ALIGN=left> 
<a name="5">&nbsp;</a>
<h3><b>5. References.</b></h3>


<br> <a href="../../biblio/generated_files/bib_biblio.html#Amadon2008a">[Amadon2008a]</a>  B. Amadon, F. Jollet and M. Torrent, "&gamma; and &beta; cerium: LDA+U calculations of ground-state parameters", Phys. Rev. B 77, 155104 (2008). <br> DOI: <a href="https://doi.org/10.1103/PhysRevB.77.155104">10.1103/PhysRevB.77.155104</a>.<br>
<br> <a href="../../biblio/generated_files/bib_biblio.html#Anisimov1991">[Anisimov1991]</a>  V. I. Anisimov and O. Gunnarsson, "Density-functional calculation of effective Coulomb interactions in metals", Phys. Rev. B 43, 7570&ndash;7574 (1991). <br> DOI: <a href="https://doi.org/10.1103/PhysRevB.43.7570">10.1103/PhysRevB.43.7570</a>.<br>
<br> <a href="../../biblio/generated_files/bib_biblio.html#Bengone2000">[Bengone2000]</a>  M. Alouani, P. Bl&ouml;chl, O. Bengone and J. Hugel, "Implementation of the projector augmented-wave LDA+U method: Application to the electronic structure of NiO", Phys. Rev. B 62, 16392 (1994).<br>
<br> <a href="../../biblio/generated_files/bib_biblio.html#Czyzyk1994">[Czyzyk1994]</a>  M. T. Czyzyk and G. A. Sawatzky, "Local-density functional and on-site correlations: The electronic structure of La<sub>2</sub>CuO<sub>4</sub> and LaCuO<sub>3</sub>", Phys. Rev. B 49, 14211 (1994).<br>
<br> <a href="../../biblio/generated_files/bib_biblio.html#Liechtenstein1995">[Liechtenstein1995]</a>  A. I. Liechtenstein, V. I. Anisimov and J. Zaanen, "Density-functional theory and strong interactions: Orbital ordering in Mott-Hubbard insulators", Phys. Rev. B 52, R5467&ndash;R5470 (1995). <br> DOI: <a href="https://doi.org/10.1103/PhysRevB.52.R5467">10.1103/PhysRevB.52.R5467</a>.<br>
<p>
<br><br><a href=#top>Go to the top</a>

<script type="text/javascript" src="../../js_files/list_internal_links_for_generated_files.js"> </script>

</body>
</html>

