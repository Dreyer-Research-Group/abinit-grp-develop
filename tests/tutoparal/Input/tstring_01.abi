#######################################
#       INPUT FILE FOR ABINIT         #
#                                     #
#  Hydronium ion + NH3 molecule       #
#  Ground state calculation           #
#  keeping O and H atoms fixed        #
#######################################

# Definition of the unit cell
# ===========================
natom         8

ntypat        3

# Species     
#             O   N   H   
znucl         
              8   7   1   

typat         
              1   3   3   2   3   3   3   3   

acell         1.90000000000000e+01   9.45000000000000e+00   9.45000000000000e+00

xcart       
              9.50000000000000e+00   4.72500000000000e+00   4.72500000000000e+00  # H2O
              8.78965194664829e+00   4.18472729860799e+00   6.37095146174340e+00  # H2O
              8.77358927451876e+00   6.36452639289158e+00   4.18567216167444e+00  # H2O
              1.70589045315426e+01   4.72500000000000e+00   4.72500000000000e+00  # NH3
              1.77127497735210e+01   4.53642422919934e+00   2.92125640616065e+00  # NH3
              1.76617271679331e+01   3.23835245125886e+00   5.79647471734616e+00  # NH3
              1.77033011428566e+01   6.37586474968890e+00   5.48523682325989e+00  # NH3
              1.14426384646064e+01   4.76789678321650e+00   4.75463090576365e+00  # proton

pp_dirpath "$ABI_PSPDIR/"
pseudos "8o_hard.paw, 7n.paw, 1h.paw"

# Electronic configuration
# ========================
nband         10       # Number of bands to compute
kptopt        0        # No autogeneration of kpts so only use Gamma (0,0,0)
charge        1.0      # Charge of the simulation cell

# Convergence parameters
# ======================
ecut          20
pawecutdg     40

# Control of the SCF cycle
# ========================
toldff        5.0d-7   # Stopping criterion of SCF cycle
nstep         50       # Maximal number of SCF steps

# Control of the relaxation
# =========================
ionmov        2        # BFGS (Broyden) algorithm for ions relaxation
optcell       0        # No cell optimization
ntime         500      # Max. number of "time" steps
tolmxf        5.0d-5   # Stopping criterion of relaxation cycle
natfix        2 
iatfix        1 4      # Keep O and N atoms fixed

# Parallelization
# ===============
paral_kgb     1
bandpp        10


##############################################################
# This section is used only for regression testing of ABINIT #
##############################################################
#%%<BEGIN TEST_INFO>
#%% [setup]
#%% executable = abinit
#%% [files]
#%% [NCPU_1]
#%% files_to_test = 
#%%   tstring_01_MPI1.abo, tolnlines = 100, tolabs = 1.100e-03, tolrel = 3.000e-03
#%% [paral_info]
#%% nprocs_to_test = 1
#%% max_nprocs = 1
#%% [extra_info]
#%% authors = G. Genestes, M. Torrent, J. Bieder
#%% keywords = 
#%% description = 
#%%   Hydronium ion + NH3 molecule      
#%%   Ground state calculation         
#%%   keeping O and H atoms fixed     
#%%<END TEST_INFO>
